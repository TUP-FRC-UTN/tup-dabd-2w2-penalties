<ng-template #sanctionType let-item>
  {{ item.sanction_type.name }}
</ng-template>

<ng-template #infraction let-item>
  @if (item.infraction_id) {
  <a [href]="['/infraction/' + item.infraction_id]">
    {{ item.infraction_id }}
  </a>
  }@else { N/A }
</ng-template>

<ng-template #date let-item>
  {{ item.created_date | date : "dd/MM/yyyy HH:mm" }}
</ng-template>

<ng-template #claimStatus let-item>
  @if(item.claim_status === 'APPROVED') {
  <span class="badge border border-success text-success p-2">{{
    item.claim_status | getValueByKeyForEnum : ClaimStatusEnum
  }}</span>
  } @else if(item.claim_status === 'REJECTED') {
  <span class="badge border border-danger text-danger p-2">{{
    item.claim_status | getValueByKeyForEnum : ClaimStatusEnum
  }}</span>
  } @else if (item.claim_status === 'SENT') {
  <span class="badge text-secondary border border-secondary p-2">{{
    item.claim_status | getValueByKeyForEnum : ClaimStatusEnum
  }}</span>
  }
</ng-template>

<app-main-container title="Reporte de Reclamos">
  <div class="d-flex justify-content-center gap-3">
    <div class="w-25">
      <app-table
        [items]="(items$ | async) || []"
        [columns]="columns"
        [isLoading]="(isLoading$ | async) || false"
        [showHeaderButton]="false"
        [showExportOptions]="false"
        [showSearchBar]="false"
        [showOnlyTableFilters]="true"
        [tableFilters]="filterConfig"
        (filterValueChange)="onFilterValueChange($event)"
      ></app-table>
    </div>
    <div class="w-75 card" style="height: 614px">
      <div class="card-body d-flex flex-column gap-3">
        <div class="w-100 pb-5 h-50 d-flex gap-4">
          <!-- GrÃ¡fico de Torta -->
          <div class="w-100">
            <h5 class="text-center mb-3">Infracciones por Estado</h5>
            <div class="w-100 d-flex justify-content-center">
              <canvas
                baseChart
                height="220px"
                [type]="'pie'"
                [datasets]="pieChartStatusDatasets"
                [labels]="pieChartStatusLabels"
                [options]="pieChartOptions"
                [plugins]="pieChartPlugins"
                [legend]="pieChartLegend"
              >
              </canvas>
            </div>
          </div>
        </div>
        <div class="w-100 h-50">
          <div class="">
            <h5 class="text-center mb-3">Infracciones por Lote</h5>
            <div class="w-100 d-flex justify-content-center">
              <canvas
                width="900px"
                height="230px"
                baseChart
                [data]="barChartPlotData"
                [options]="barChartOptions"
                [plugins]="barChartPlugins"
                [legend]="barChartLegend"
                [type]="'bar'"
              >
              </canvas>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</app-main-container>
