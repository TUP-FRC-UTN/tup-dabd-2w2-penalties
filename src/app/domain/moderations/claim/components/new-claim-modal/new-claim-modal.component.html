<ng-template #claimModal let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Nuevo Reclamo</h4>
    <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
  </div>
  <div class="modal-body">
    <form #claimForm="ngForm" (ngSubmit)="submitClaim()">
      <div class="mb-3">
        <label for="plotSelectionClaim" class="form-label">Lote*</label>
        <select #plotControlClaim="ngModel"
                [ngClass]="{'is-invalid': plotControlClaim.invalid && (plotControlClaim.dirty || plotControlClaim.touched)}"
                class="form-select" id="plotSelectionClaim" [(ngModel)]="plotId" name="plotIdClaim" required>
          @if (plots) {
            @for (plot of plots; track plot.plot_number) {
              <option value="{{ plot.plot_number }}">
                {{ plot.plot_number }} - {{ plot.plot_type }}
              </option>
            }
          } @else {
            <option value="1">1</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
          }
        </select>
        @if (plotControlClaim.invalid && (plotControlClaim.dirty || plotControlClaim.touched)) {
          @if (plotControlClaim.getError('required')) {
            <div class="invalid-feedback">Este campo es obligatorio</div>
          }
        }
      </div>

      <div class="mb-3">
        <label for="SanctionTypeSelectClaim" class="form-label">Tipo de Infracción *</label>
        <select #sanctionControlClaim="ngModel"
                [ngClass]="{'is-invalid': sanctionControlClaim.invalid && (sanctionControlClaim.dirty || sanctionControlClaim.touched)}"
                class="form-select" id="SanctionTypeSelectClaim" [(ngModel)]="sanctionTypeId" name="sanctionTypeIdClaim"
                required>
          @if (sanctionTypes) {
            @for (sanction of sanctionTypes; track sanction.id) {
              <option value="{{ sanction.id }}">
                {{ sanction.name }}
              </option>
            }
          } @else {
            <option value="999">Ruidos molestos(mock)</option>
            <option value="1000">Egreso tardío(mock)</option>
          }
        </select>
        @if (sanctionControlClaim.invalid && (sanctionControlClaim.dirty || sanctionControlClaim.touched)) {
          @if (sanctionControlClaim.getError('required')) {
            <div class="invalid-feedback">Este campo es obligatorio</div>
          }
        }
      </div>

      <div class="mb-3">
        <label for="ClaimDescription" class="form-label">Descripción</label>
        <textarea class="form-control" id="ClaimDescription" rows="3" #descriptionControlClaim="ngModel"
                  [ngClass]="{'is-invalid': descriptionControlClaim.invalid && (descriptionControlClaim.dirty || descriptionControlClaim.touched)}"
                  [(ngModel)]="description" name="descriptionClaim" required></textarea>
        @if (descriptionControlClaim.invalid && (descriptionControlClaim.dirty || descriptionControlClaim.touched)) {
          @if (descriptionControlClaim.getError('required')) {
            <div class="invalid-feedback">Este campo es obligatorio</div>
          }
        }
      </div>

      <div class="mb-3">
        <label for="formFileMultiple" class="form-label">multiples archivos son recibidos</label>
        <input class="form-control" type="file" id="formFileMultiple" (change)="onFilesSelected($event)"  multiple>
      </div>


      <button type="submit" class="btn btn-primary" [disabled]="claimForm.invalid">Crear</button>
    </form>
  </div>
</ng-template>

<button class="btn btn-lg btn-outline-primary" (click)="openClaimModal(claimModal)">Nuevo Reclamo</button>
