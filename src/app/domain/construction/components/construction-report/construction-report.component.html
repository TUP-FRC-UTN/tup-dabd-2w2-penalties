<ng-template #statusTemplate let-item>
  <span class="badge text-secondary border border-secondary p-2">{{
    item.construction_status | getValueByKeyForEnum : CONSTRUCTION_STATUSES_ENUM
  }}</span>
</ng-template>

<app-main-container title="Reporte de Infracciones">
  <div class="d-flex justify-content-center gap-3">
    <div class="w-25">
      <app-table
        [items]="(items$ | async) || []"
        [columns]="columns"
        [isLoading]="(isLoading$ | async) || false"
        [showHeaderButton]="false"
        [showExportOptions]="false"
        [showSearchBar]="false"
        [showOnlyTableFilters]="true"
        [tableFilters]="filterConfig"
        (filterValueChange)="onFilterValueChange($event)"
      ></app-table>
    </div>
    <div class="w-75 card" style="height: 614px">
      <div class="card-body d-flex flex-column gap-3">
        <div class="w-100 h-75 pb-5">
          <!-- Gr치fico de Torta -->
          <div class="w-100 d-flex flex-column align-items-center">
            <h5 class="">Construcciones por Estado</h5>
            <canvas
              baseChart
              width="600px"
              height="320px"
              [type]="'pie'"
              [datasets]="pieChartStatusDatasets"
              [labels]="pieChartStatusLabels"
              [options]="pieChartOptions"
              [plugins]="pieChartPlugins"
              [legend]="pieChartLegend"
            >
            </canvas>
          </div>
        </div>
        <div class="w-100 d-flex gap-3 h-25">
          <!-- Gr치fico de Torta -->
          <div class="w-50">
            <div class="card">
              <div class="card-body">
                <div class="d-flex align-items-center mb-2">
                  <div
                    class="bg-primary text-white me-3 d-flex justify-content-center align-items-center rounded-circle"
                    style="height: 36px; width: 36px"
                  >
                    <i class="bi bi-calendar-check"></i>
                  </div>
                  <h6 class="card-subtitle text-muted mb-0">
                    Duraci칩n promedio
                  </h6>
                </div>
                <h2 class="card-title mb-0 text-success">
                  {{ averageDuration }}
                </h2>
                <small class="text-muted"
                  >Promedio de duraci칩n de las obras</small
                >
              </div>
            </div>
          </div>
          <div class="w-50">
            <div class="card">
              <div class="card-body">
                <div class="d-flex align-items-center mb-2">
                  <div
                    class="bg-warning text-white me-3 d-flex justify-content-center align-items-center rounded-circle"
                    style="height: 36px; width: 36px"
                  >
                    <i class="bi bi-cone-striped"></i>
                  </div>
                  <h6 class="card-subtitle text-muted mb-0">
                    Cantidad de trabajadores promedio
                  </h6>
                </div>
                <h2 class="card-title mb-0 text-success">
                  {{ averageWorkers }}
                </h2>
                <small class="text-muted"
                  >Promedio de trabajadores por obra</small
                >
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</app-main-container>
